<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<xsl:stylesheet xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns:fo=\"http://www.w3.org/1999/XSL/Format\" xmlns:barcode=\"http://barcode4j.krysalis.org/ns\" version=\"1.1\" exclude-result-prefixes=\"fo\">\n    <xsl:output method=\"xml\" version=\"1.0\" omit-xml-declaration=\"no\" indent=\"yes\"/>\n    <!--<xsl:variable name=\"refRep\" select=\"//refRep\"/>-->\n    <xsl:variable name=\"header\" select=\"//packing_slip\"/>\n    <xsl:template match=\"/\">\n        <fo:root>\n            <fo:layout-master-set>\n                <fo:simple-page-master master-name=\"letter\" page-height=\"8.5in\" page-width=\"11in\" margin-top=\"0.2in\" margin-bottom=\"0.2in\" margin-left=\"0.3in\" margin-right=\"0.4in\">\n                    <fo:region-body margin-top=\"4.5in\" margin-bottom=\"1.3in\"/>\n                    <fo:region-before precedence=\"true\" extent=\"1in\"/>\n                    <fo:region-after precedence=\"true\" extent=\"0.2in\"/>\n                    <!--  <fo:region-end precedence=\"true\" extent=\"2.9in\" /> -->\n                </fo:simple-page-master>\n\n                <fo:page-sequence-master master-name=\"default\">\n                    <fo:repeatable-page-master-reference master-reference=\"letter\"/>\n                </fo:page-sequence-master>\n            </fo:layout-master-set>\n\n\n            <xsl:for-each select=\".//items[1]\">\n                <fo:page-sequence master-reference=\"default\">\n                    <fo:static-content flow-name=\"xsl-region-before\">\n                        <xsl:call-template name=\"logoAddresses\"/>\n                        <xsl:call-template name=\"shipTo\"/>\n                    </fo:static-content>\n\n                    <fo:static-content flow-name=\"xsl-region-after\">\n                        <xsl:call-template name=\"emptyTable\"/>\n                        <xsl:call-template name=\"footer\"/>\n                    </fo:static-content>\n                    <fo:flow flow-name=\"xsl-region-body\">\n                        <xsl:call-template name=\"item-table\"/>\n                        <fo:block id=\"lastPage\"/>\n                    </fo:flow>\n                </fo:page-sequence>\n            </xsl:for-each>\n        </fo:root>\n    </xsl:template>\n\n    <xsl:template name=\"footer\" margin-right=\"0.4in\" background-color=\"white\">\n        <fo:block-container>\n            <fo:block font-weight=\"bold\" font-size=\"30\" text-align=\"right\" margin-right=\"0.15in\">\n                <fo:external-graphic content-width=\"5in\">\n                    <xsl:attribute name=\"src\"> url('https://prod-template-service-media.s3.amazonaws.com/packing-slips/4b42371f210307274c00a77c5f257cd41ced4281/templates/c/csnStores/api/images/bottom.JPG') </xsl:attribute>\n                </fo:external-graphic>\n            </fo:block>\n\n        </fo:block-container>\n    </xsl:template>\n\n    <xsl:template name=\"logoAddresses\">\n        <fo:block>\n            <fo:table font-size=\"10pt\" background-color=\"white\">\n                <fo:table-column column-width=\"60%\"/>\n                <!--  <fo:table-column column-width=\"90%\" />\n                -->\n                <fo:table-body>\n                    <fo:table-row>\n                        <fo:table-cell padding=\"2mm\">\n                            <fo:block font-weight=\"bold\" font-size=\"30\" text-align=\"left\" margin-top=\"-7mm\" margin-left=\"5mm\">\n                                <fo:external-graphic content-width=\"2.2in\">\n                                    <xsl:attribute name=\"src\"> url('https://prod-template-service-media.s3.amazonaws.com/packing-slips/4b42371f210307274c00a77c5f257cd41ced4281/templates/c/csnStores/api/images/logo1.png') </xsl:attribute>\n                                </fo:external-graphic>\n                            </fo:block>\n                        </fo:table-cell>\n                    </fo:table-row>\n                </fo:table-body>\n            </fo:table>\n        </fo:block>\n    </xsl:template>\n\n    <xsl:template name=\"shipTo\">\n        <fo:block>\n            <fo:table background-color=\"white\">\n                <fo:table-column column-width=\"25%\"/>\n                <fo:table-column column-width=\"25%\"/>\n                <fo:table-column column-width=\"50%\"/>\n                <fo:table-body>\n                    <fo:table-row>\n                        <fo:table-cell border=\"1pt solid grey\" padding=\"0.5mm\" margin-right=\"0in\" background-color=\"#c0c0c0\" number-columns-spanned=\"2\">\n\n                            <fo:block font-size=\"9\" text-align=\"left\" font-weight=\"bold\" background-color=\"#c0c0c0\" margin-left=\"2mm\">ORDER INFORMATION</fo:block>\n\n                        </fo:table-cell>\n                        <fo:table-cell margin-left=\"2mm\" number-rows-spanned=\"4\">\n                            <fo:block font-weight=\"bold\" margin-top=\"-1mm\">\n                                <fo:external-graphic content-width=\"4.8in\">\n                                    <xsl:attribute name=\"src\"> url('https://prod-template-service-media.s3.amazonaws.com/packing-slips/4b42371f210307274c00a77c5f257cd41ced4281/templates/c/csnStores/api/images/thanks.JPG') </xsl:attribute>\n                                </fo:external-graphic>\n                            </fo:block>\n\n                        </fo:table-cell>\n                    </fo:table-row>\n                    <fo:table-row>\n\n                        <fo:table-cell border=\"1pt solid grey\" padding=\"0.5mm\" margin-right=\"0in\" number-columns-spanned=\"2\">\n                            <fo:block font-size=\"9\" padding-top=\"2mm\" margin-left=\"2mm\">Page: <fo:page-number/> of <fo:page-number-citation ref-id=\"lastPage\"/> • Package: <xsl:value-of select=\"$header/pack_number\"/>  of <xsl:value-of select=\"$header/pack_total\"/> • Order Date: <xsl:value-of select=\"$header/purchase_order_date\"/></fo:block>\n                            <fo:block font-size=\"9\" margin-left=\"2mm\">P.O. Number:&#160; <xsl:value-of select=\"$header/purchase_order_number\"/></fo:block>\n                            <fo:block font-size=\"9\" margin-left=\"2mm\" padding-bottom=\"7mm\">Shipped Via:&#160;<xsl:value-of select=\"$header/carrier/description\"/>&#160;</fo:block>\n                        </fo:table-cell>\n                    </fo:table-row>\n                    <fo:table-row>\n                        <fo:table-cell border=\"1pt solid grey\" padding=\"0.5mm\" margin-right=\"0in\" background-color=\"#c0c0c0\">\n                            <fo:block margin-left=\"2mm\" font-size=\"9\" text-align=\"left\" font-weight=\"bold\">SHIPPED TO</fo:block>\n\n                        </fo:table-cell>\n                        <fo:table-cell border=\"1pt solid grey\" padding=\"0.5mm\" margin-right=\"0in\" background-color=\"#c0c0c0\">\n                            <fo:block margin-left=\"2mm\" font-size=\"9\" text-align=\"left\" font-weight=\"bold\">BILLED TO</fo:block>\n\n                        </fo:table-cell>\n\n\n                    </fo:table-row>\n                    <fo:table-row>\n                        <fo:table-cell border=\"1pt solid grey\" margin-right=\"0in\" padding-bottom=\"0mm\">\n                            <fo:block font-size=\"9\">\n                                <xsl:for-each select=\"$header/ship_to_address\">\n                                    <fo:block margin-left=\"2mm\"><xsl:value-of select=\"./name\"/>&#160;</fo:block>\n                                    <fo:block  margin-left=\"2mm\" font-size=\"9\"  ><xsl:value-of select=\"./warehouse_number\"/></fo:block>\n                                    <xsl:choose>\n                                        <xsl:when test=\"string-length(./address2) &gt; 0\">\n                                            <fo:block margin-left=\"2mm\"><xsl:value-of select=\"./address1\"/>&#160;</fo:block>\n                                            <fo:block margin-left=\"2mm\"><xsl:value-of select=\"./address2\"/>&#160;</fo:block>\n                                        </xsl:when>\n                                        <xsl:otherwise>\n                                            <fo:block margin-left=\"2mm\"><xsl:value-of select=\"./address1\"/>&#160;</fo:block>\n                                        </xsl:otherwise>\n                                    </xsl:choose>\n                                    <fo:block margin-left=\"2mm\">\n                                        <xsl:value-of select=\"./city\"/>,&#160;<xsl:value-of select=\"./state\"/>&#160;<xsl:value-of select=\"./postal_code\"/>&#160;<xsl:value-of select=\"./country\"/>\n                                    </fo:block>\n                                </xsl:for-each>\n                            </fo:block>\n                        </fo:table-cell>\n                        <fo:table-cell border=\"1pt solid grey\" margin-right=\"0in\" padding-bottom=\"0mm\">\n\n                            <fo:block font-size=\"9\" margin-left=\"2mm\">\n                                <xsl:for-each select=\"$header/bill_to_address\">\n                                    <fo:block margin-left=\"2mm\"><xsl:value-of select=\"./name\"/>&#160;</fo:block>\n                                    <xsl:choose>\n                                        <xsl:when test=\"string-length(./address2) &gt; 0\">\n                                            <fo:block margin-left=\"2mm\"><xsl:value-of select=\"./address1\"/>&#160;</fo:block>\n                                            <fo:block margin-left=\"2mm\"><xsl:value-of select=\"./address2\"/>&#160;</fo:block>\n                                        </xsl:when>\n                                        <xsl:otherwise>\n                                            <fo:block margin-left=\"2mm\"><xsl:value-of select=\"./address1\"/>&#160;</fo:block>\n                                        </xsl:otherwise>\n                                    </xsl:choose>\n                                    <fo:block margin-left=\"2mm\">\n                                        <xsl:value-of select=\"./city\"/>,&#160;<xsl:value-of select=\"./state\"/>&#160;<xsl:value-of select=\"./postal_code\"/>&#160;<xsl:value-of select=\"./country\"/>\n                                    </fo:block>\n                                </xsl:for-each>\n                            </fo:block>\n                        </fo:table-cell>\n\n                    </fo:table-row>\n                </fo:table-body>\n            </fo:table>\n        </fo:block>\n        <fo:block text-align=\"center\" padding-top=\"2mm\"> Returns are easy at <fo:inline font-weight=\"bold\">wayfair.com/returns •</fo:inline> For help or questions visit<fo:inline font-weight=\"bold\"> wayfair.com/help</fo:inline>\n        </fo:block>\n    </xsl:template>\n\n    <xsl:template name=\"item-table\">\n        <fo:block font-size=\"10\">\n            <fo:table>\n                <fo:table-column column-width=\"20%\"/>\n                <fo:table-column column-width=\"9%\"/>\n                <fo:table-column column-width=\"69%\"/>\n                <fo:table-header>\n                    <fo:table-row text-align=\"center\" padding-top=\"0.2in\" padding-right=\"100mm\" font-size=\"10\" border-bottom-style=\"solid\" border-bottom-width=\"0.40mm\">\n                        <fo:table-cell padding=\"1mm\" font-weight=\"bold\" text-align=\"center\" background-color=\"#c0c0c0\">\n                            <fo:block> ITEM # </fo:block>\n                        </fo:table-cell>\n                        <fo:table-cell padding=\"1mm\" font-weight=\"bold\" text-align=\"center\" background-color=\"#c0c0c0\">\n                            <fo:block> QTY </fo:block>\n                        </fo:table-cell>\n                        <fo:table-cell padding=\"1mm\" font-weight=\"bold\" text-align=\"center\" background-color=\"#c0c0c0\">\n                            <fo:block> DESCRIPTION </fo:block>\n                        </fo:table-cell>\n                    </fo:table-row>\n                </fo:table-header>\n                <fo:table-body>\n                    <xsl:for-each select=\"//items/vendor_part_number\">\n                        <fo:table-row font-size=\"7.5\">\n                            <fo:table-cell padding-left=\"2mm\" padding-top=\"2mm\" text-align=\"center\">\n                                <fo:block-container overflow=\"hidden\">\n                                    <fo:block font-weight=\"plain\">\n                                        <xsl:value-of select=\"./../vendor_part_number\"/>\n                                    </fo:block>\n                                </fo:block-container>\n                            </fo:table-cell>\n                            <fo:table-cell padding-left=\"1mm\" padding-top=\"1mm\" text-align=\"center\">\n                                <fo:block-container overflow=\"hidden\">\n                                    <fo:block font-weight=\"plain\">\n                                        <xsl:value-of select=\"./../ship_quantity\"/>\n                                    </fo:block>\n                                </fo:block-container>\n                            </fo:table-cell>\n                            <fo:table-cell padding-left=\"1mm\" padding-top=\"1mm\" text-align=\"left\">\n                                <fo:block-container overflow=\"hidden\">\n                                    <fo:block font-weight=\"plain\">\n                                        <xsl:value-of select=\"./../product_description\"/>\n                                    </fo:block>\n                                </fo:block-container>\n                            </fo:table-cell>\n                        </fo:table-row>\n                    </xsl:for-each>\n                </fo:table-body>\n            </fo:table>\n        </fo:block>\n    </xsl:template>\n\n    <xsl:template name=\"emptyTable\">\n        <fo:block font-size=\"10\" margin-top=\"-80mm\">\n            <fo:table>\n                <fo:table-column column-width=\"20%\"/>\n                <fo:table-column column-width=\"9%\"/>\n                <fo:table-column column-width=\"69%\"/>\n\n                <fo:table-body>\n\n                    <fo:table-row height=\"2.4in\" font-size=\"7\" border-top-style=\"solid\" border-top-width=\"0.40mm\" border-bottom-style=\"solid\" border-bottom-width=\"0.40mm\">\n                        <fo:table-cell padding-left=\"2mm\" padding-top=\"2mm\" text-align=\"center\" border=\"solid 0.40mm grey\">\n                            <fo:block> &#160; </fo:block>\n                        </fo:table-cell>\n\n                        <fo:table-cell padding-left=\"1mm\" padding-top=\"1mm\" text-align=\"left\" border=\"solid 0.40mm grey\">\n                            <fo:block> &#160; </fo:block>\n                        </fo:table-cell>\n                        <fo:table-cell padding-left=\"1mm\" padding-top=\"1mm\" text-align=\"left\" border=\"solid 0.40mm grey\">\n                            <fo:block> &#160; </fo:block>\n                        </fo:table-cell>\n                    </fo:table-row>\n                </fo:table-body>\n            </fo:table>\n        </fo:block>\n    </xsl:template>\n\n    <xsl:template name=\"sum-qty\">\n        <xsl:param name=\"a\"/>\n        <!--list qty-->\n        <xsl:param name=\"b\"/>\n        <!--number-->\n        <xsl:param name=\"qty\"/>\n        <!--qty-->\n        <xsl:param name=\"sum\"/>\n\n        <xsl:choose>\n            <xsl:when test=\"(count($a) &gt; 0)\">\n                <xsl:if test=\"($a[1] = $b)\">\n                    <xsl:call-template name=\"sum-qty\">\n                        <xsl:with-param name=\"a\" select=\"$a[position() != 1]\"/>\n                        <xsl:with-param name=\"b\" select=\"$b\"/>\n                        <xsl:with-param name=\"qty\" select=\"$qty[position() != 1]\"/>\n                        <xsl:with-param name=\"sum\" select=\"$sum + $qty[1]\"/>\n                    </xsl:call-template>\n                </xsl:if>\n\n                <xsl:if test=\"($a[1] != $b)\">\n                    <xsl:call-template name=\"sum-qty\">\n                        <xsl:with-param name=\"a\" select=\"$a[position() != 1]\"/>\n                        <xsl:with-param name=\"b\" select=\"$b\"/>\n                        <xsl:with-param name=\"qty\" select=\"$qty[position() != 1]\"/>\n                        <xsl:with-param name=\"sum\" select=\"$sum\"/>\n                    </xsl:call-template>\n                </xsl:if>\n            </xsl:when>\n\n            <xsl:otherwise>\n                <xsl:value-of select=\"$sum\"/>\n            </xsl:otherwise>\n        </xsl:choose>\n    </xsl:template>\n\n</xsl:stylesheet>
